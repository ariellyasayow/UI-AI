<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kidney Stone AI</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Progress Steps -->
        <div class="progress-container">
            <div class="progress-line">
                <div class="progress-line-fill" id="progressFill"></div>
            </div>
            <div class="progress-step active" data-step="1">
                <div class="progress-circle">1</div>
                <div class="progress-label">Upload</div>
            </div>
            <div class="progress-step" data-step="2">
                <div class="progress-circle">2</div>
                <div class="progress-label">Preview</div>
            </div>
            <div class="progress-step" data-step="3">
                <div class="progress-circle">3</div>
                <div class="progress-label">Analyze</div>
            </div>
            <div class="progress-step" data-step="4">
                <div class="progress-circle">4</div>
                <div class="progress-label">Results</div>
            </div>
        </div>

        <!-- Step 1: Upload -->
        <div class="step-content active" id="step1">
            <h1>ü©∫ Kidney Stone AI</h1>
            <p class="subtitle">Upload a CT scan image and let our AI help identify possible kidney stones.</p>
            
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">‚òÅÔ∏è‚Üë</div>
                <div class="upload-text">Drag & drop an image here</div>
                <div class="upload-subtext">or</div>
                <button class="browse-btn" onclick="document.getElementById('fileInput').click()">Browse</button>
                <input type="file" id="fileInput" accept="image/*">
            </div>
        </div>

        <!-- Step 2: Preview & Replace -->
        <div class="step-content" id="step2">
            <h1>Preview Image</h1>
            <p class="subtitle">Review your CT scan image before analysis</p>
            
            <img id="previewImage" class="preview-image" alt="Preview">
            
            <div class="action-buttons">
                <button class="btn-secondary" onclick="replaceImage()">üîÑ Replace Image</button>
                <button class="btn-primary" onclick="goToStep(3)">Upload ‚ûú</button>
            </div>
        </div>

        <!-- Step 3: Analysis -->
        <div class="step-content" id="step3">
            <h1>Analyzing...</h1>
            <p class="subtitle">Our AI is processing your CT scan image</p>
            
            <div class="analysis-container">
                <div class="spinner"></div>
                <div class="analysis-text">Analyzing CT scan...</div>
                <div class="analysis-subtext">This may take a few moments</div>
            </div>
        </div>

        <!-- Step 4: Results -->
        <div class="step-content" id="step4">
            <h1>Analysis Complete</h1>
            <p class="subtitle">Here are the results from your CT scan</p>
            
            <div class="results-container">
                <div class="results-header">
                    <div class="results-icon">üìä</div>
                    <div class="results-title">Kidney stone detected</div>
                </div>
                <div class="results-content" id="resultsText">
                    The uploaded CT scan shows indications of kidney stone formation.
                </div>
                <img id="resultsImage" class="results-image" alt="Results">
            </div>
            
            <div class="action-buttons">
                <button class="btn-secondary" onclick="resetApp()">üîÑ New Scan</button>
                <button class="btn-primary" onclick="downloadResults()">üíæ Save Results</button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let uploadedImage = null;

        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const previewImage = document.getElementById('previewImage');
        const resultsImage = document.getElementById('resultsImage');
        const resultsText = document.getElementById('resultsText');

        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        function handleFile(file) {
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    uploadedImage = e.target.result;
                    previewImage.src = uploadedImage;
                    goToStep(2);
                };
                reader.readAsDataURL(file);
            } else {
                alert('Please upload an image file');
            }
        }

        function goToStep(step) {
            currentStep = step;
            
            // Update step content
            document.querySelectorAll('.step-content').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById(`step${step}`).classList.add('active');
            
            // Update progress
            document.querySelectorAll('.progress-step').forEach((el, index) => {
                if (index < step - 1) {
                    el.classList.add('completed');
                    el.classList.remove('active');
                } else if (index === step - 1) {
                    el.classList.add('active');
                    el.classList.remove('completed');
                } else {
                    el.classList.remove('active', 'completed');
                }
            });
            
            // Update progress line
            const progress = ((step - 1) / 3) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Auto-analyze on step 3
            if (step === 3) {
                setTimeout(() => {
                    simulateAnalysis();
                }, 3000);
            }
        }

        function replaceImage() {
            fileInput.click();
        }

        function simulateAnalysis() {
            resultsImage.src = uploadedImage;
            
            const sampleResults = [
                "Analysis complete. Two potential kidney stones detected in the right kidney, measuring approximately 4mm and 6mm. The stones appear to be located in the upper pole.",
                "Scan reviewed. One small calcification identified in the left kidney (approximately 3mm). This could be a kidney stone or benign calcification.",
                "Analysis shows no obvious kidney stones detected. However, some minor calcifications are visible. Clinical evaluation recommended.",
                "Multiple small kidney stones detected bilaterally. Largest stone measures approximately 8mm in the right kidney."
            ];
            
            resultsText.textContent = sampleResults[Math.floor(Math.random() * sampleResults.length)];
            goToStep(4);
        }

        function resetApp() {
            currentStep = 1;
            uploadedImage = null;
            fileInput.value = '';
            goToStep(1);
        }

        function downloadResults() {
            alert('Results would be downloaded as PDF in a real application');
        }
    </script>
</body>
</html>